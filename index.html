<!DOCTYPE html>
<html>
<head>
    <title>Audio Grid Debug</title>
    <style>
        .audio-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .audio-cell {
            border: 1px solid #ddd;
            padding: 10px;
            width: 200px;
        }
    </style>
</head>
<body>
    <div id="audio-comparison">
        <div id="target-selector">
            <label for="instrument-select">Select Target Instrument: </label>
            <select id="instrument-select">
                <option value="Bassoon">Bassoon</option>
                <option value="Cello">Cello</option>
                <option value="Clarinet">Clarinet</option>
            </select>
        </div>
        
        <div class="audio-grid" id="audio-grid">
            <div class="audio-cell" id="input-audio-cell">
                <strong>Input</strong>
                <div id="input-audio-container"></div>
            </div>
            <div class="audio-cell" id="target-audio-cell">
                <strong>Target</strong>
                <div id="target-audio-container"></div>
            </div>
        </div>
    </div>

    <script>
    // Simplified audio track configuration
    const audioTracks = [
        { 
            trackName: 'random_track210026_1_violin', 
            sourceInstrument: 'Violin' 
        }
    ];
    
    // Function to create audio elements with extensive logging
    function createAudioElement(src) {
        console.log('Attempting to create audio element with src:', src);
        
        // Create container div to ensure visibility
        const container = document.createElement('div');
        container.style.border = '1px solid red';
        container.style.margin = '5px';
        container.style.padding = '5px';
        
        // Create audio element
        const audioElement = document.createElement('audio');
        audioElement.controls = true;
        audioElement.style.width = '100%';
        
        // Create source element
        const sourceElement = document.createElement('source');
        sourceElement.type = 'audio/wav';
        sourceElement.src = src;
        
        // Log source details
        console.log('Source element details:', {
            type: sourceElement.type,
            src: sourceElement.src
        });
        
        // Attach error and load event listeners for debugging
        audioElement.addEventListener('error', (e) => {
            console.error('Audio element error:', e);
        });
        
        audioElement.addEventListener('loadedmetadata', () => {
            console.log('Audio metadata loaded successfully');
        });
        
        // Assemble the audio element
        audioElement.appendChild(sourceElement);
        
        // Add a visible marker
        const label = document.createElement('div');
        label.textContent = src;
        label.style.fontSize = '10px';
        label.style.wordBreak = 'break-all';
        
        container.appendChild(label);
        container.appendChild(audioElement);
        
        return container;
    }
    
    // Function to update audio tracks
    function updateAudioTracks(selectedInstrument) {
        const configurations = [
            { containerId: 'input-audio-container', setting: 'input' },
            { containerId: 'target-audio-container', setting: 'targets' }
        ];
    
        // Clear existing audio elements
        configurations.forEach(config => {
            const container = document.getElementById(config.containerId);
            container.innerHTML = '';
        });
    
        // Add new audio elements for each track
        audioTracks.forEach(track => {
            configurations.forEach(config => {
                const container = document.getElementById(config.containerId);
                const basePath = 'audio/coco-ablation';
                
                let fullPath;
                if (config.setting === 'input') {
                    fullPath = `${basePath}/${config.setting}/${track.trackName}.wav`;
                } else if (config.setting === 'targets') {
                    fullPath = `${basePath}/${config.setting}/${selectedInstrument}/target.wav`;
                }
    
                console.log('Full path for audio:', fullPath);
                
                // Create and append audio element
                const audioElement = createAudioElement(fullPath);
                container.appendChild(audioElement);
            });
        });
    }
    
    // Add event listener to instrument selector
    document.getElementById('instrument-select').addEventListener('change', function() {
        const selectedInstrument = this.value;
        updateAudioTracks(selectedInstrument);
    });
    
    // Initial load
    document.addEventListener('DOMContentLoaded', () => {
        updateAudioTracks('Bassoon');
    });
    </script>
</body>
</html>
